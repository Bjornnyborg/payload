{"version":3,"sources":["../src/AdminBar.tsx"],"sourcesContent":["'use client'\nimport React, { useEffect, useState } from 'react'\n\nconst dummyUser = {\n  id: '12345',\n  email: 'dev@email.com',\n}\n\nimport type { PayloadAdminBarProps, PayloadMeUser } from './types.js'\n\nexport const PayloadAdminBar: React.FC<PayloadAdminBarProps> = (props) => {\n  const {\n    id: docID,\n    adminPath = '/admin',\n    apiPath = '/api',\n    authCollectionSlug = 'users',\n    className,\n    classNames,\n    cmsURL = 'http://localhost:8000',\n    collectionLabels,\n    collectionSlug,\n    createProps,\n    devMode,\n    divProps,\n    editProps,\n    logo,\n    logoProps,\n    logoutProps,\n    onAuthChange,\n    onPreviewExit,\n    preview,\n    previewProps,\n    style,\n    unstyled,\n    userProps,\n  } = props\n\n  const [user, setUser] = useState<PayloadMeUser>()\n\n  useEffect(() => {\n    const fetchMe = async () => {\n      try {\n        const meRequest = await fetch(`${cmsURL}${apiPath}/${authCollectionSlug}/me`, {\n          credentials: 'include',\n          method: 'get',\n        })\n        const meResponse = await meRequest.json()\n        const { user } = meResponse\n\n        if (user) {\n          setUser(user)\n        } else {\n          if (devMode !== true) {\n            setUser(null)\n          } else {\n            setUser(dummyUser)\n          }\n        }\n      } catch (err) {\n        console.warn(err)\n        if (devMode === true) {\n          setUser(dummyUser)\n        }\n      }\n    }\n\n    void fetchMe()\n  }, [cmsURL, adminPath, apiPath, devMode])\n\n  useEffect(() => {\n    if (typeof onAuthChange === 'function') {\n      onAuthChange(user)\n    }\n  }, [user, onAuthChange])\n\n  if (user) {\n    const { id: userID, email } = user\n\n    return (\n      <div\n        className={className}\n        id=\"payload-admin-bar\"\n        style={{\n          ...(unstyled !== true\n            ? {\n                alignItems: 'center',\n                backgroundColor: '#222',\n                boxSizing: 'border-box',\n                color: '#fff',\n                display: 'flex',\n                fontFamily:\n                  '-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, sans-serif',\n                fontSize: 'small',\n                left: 0,\n                minWidth: '0',\n                padding: '0.5rem',\n                position: 'fixed',\n                top: 0,\n                width: '100%',\n                zIndex: 99999,\n              }\n            : {}),\n          ...style,\n        }}\n      >\n        <a\n          className={classNames?.logo}\n          href={`${cmsURL}${adminPath}`}\n          {...logoProps}\n          style={{\n            ...(unstyled !== true\n              ? {\n                  alignItems: 'center',\n                  color: 'inherit',\n                  display: 'flex',\n                  flexShrink: 0,\n                  height: '20px',\n                  marginRight: '10px',\n                  textDecoration: 'none',\n                  ...(logoProps?.style\n                    ? {\n                        ...logoProps.style,\n                      }\n                    : {}),\n                }\n              : {}),\n          }}\n        >\n          {logo || 'Payload CMS'}\n        </a>\n        <a\n          className={classNames?.user}\n          href={`${cmsURL}${adminPath}/collections/${authCollectionSlug}/${userID}`}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n          {...userProps}\n          style={{\n            ...(unstyled !== true\n              ? {\n                  color: 'inherit',\n                  display: 'block',\n                  marginRight: '10px',\n                  minWidth: '50px',\n                  overflow: 'hidden',\n                  textDecoration: 'none',\n                  textOverflow: 'ellipsis',\n                  whiteSpace: 'nowrap',\n                  ...(userProps?.style\n                    ? {\n                        ...userProps.style,\n                      }\n                    : {}),\n                }\n              : {}),\n          }}\n        >\n          <span\n            style={{\n              ...(unstyled !== true\n                ? {\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    whiteSpace: 'nowrap',\n                  }\n                : {}),\n            }}\n          >\n            {email || 'Profile'}\n          </span>\n        </a>\n        <div\n          className={classNames?.controls}\n          {...divProps}\n          style={{\n            ...(unstyled !== true\n              ? {\n                  alignItems: 'center',\n                  display: 'flex',\n                  flexGrow: 1,\n                  flexShrink: 1,\n                  justifyContent: 'flex-end',\n                  marginRight: '10px',\n                  ...(divProps?.style\n                    ? {\n                        ...divProps.style,\n                      }\n                    : {}),\n                }\n              : {}),\n          }}\n        >\n          {collectionSlug && docID && (\n            <a\n              className={classNames?.edit}\n              href={`${cmsURL}${adminPath}/collections/${collectionSlug}/${docID}`}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n              {...editProps}\n              style={{\n                display: 'block',\n                ...(unstyled !== true\n                  ? {\n                      color: 'inherit',\n                      flexShrink: 1,\n                      marginRight: '10px',\n                      overflow: 'hidden',\n                      textDecoration: 'none',\n                      textOverflow: 'ellipsis',\n                      whiteSpace: 'nowrap',\n                      ...(editProps?.style\n                        ? {\n                            ...editProps.style,\n                          }\n                        : {}),\n                    }\n                  : {}),\n              }}\n            >\n              <span\n                style={{\n                  ...(unstyled !== true\n                    ? {\n                        overflow: 'hidden',\n                        textOverflow: 'ellipsis',\n                        whiteSpace: 'nowrap',\n                      }\n                    : {}),\n                }}\n              >\n                {`Edit ${collectionLabels?.singular || 'page'}`}\n              </span>\n            </a>\n          )}\n          {collectionSlug && (\n            <a\n              className={classNames?.create}\n              href={`${cmsURL}${adminPath}/collections/${collectionSlug}/create`}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n              {...createProps}\n              style={{\n                ...(unstyled !== true\n                  ? {\n                      color: 'inherit',\n                      display: 'block',\n                      flexShrink: 1,\n                      overflow: 'hidden',\n                      textDecoration: 'none',\n                      textOverflow: 'ellipsis',\n                      whiteSpace: 'nowrap',\n                      ...(createProps?.style\n                        ? {\n                            ...createProps.style,\n                          }\n                        : {}),\n                    }\n                  : {}),\n              }}\n            >\n              <span\n                style={{\n                  ...(unstyled !== true\n                    ? {\n                        overflow: 'hidden',\n                        textOverflow: 'ellipsis',\n                        whiteSpace: 'nowrap',\n                      }\n                    : {}),\n                }}\n              >\n                {`New ${collectionLabels?.singular || 'page'}`}\n              </span>\n            </a>\n          )}\n          {preview && (\n            <button\n              className={classNames?.preview}\n              onClick={onPreviewExit}\n              {...previewProps}\n              style={{\n                ...(unstyled !== true\n                  ? {\n                      background: 'none',\n                      border: 'none',\n                      color: 'inherit',\n                      cursor: 'pointer',\n                      fontFamily: 'inherit',\n                      fontSize: 'inherit',\n                      marginLeft: '10px',\n                      padding: 0,\n                      ...(previewProps?.style\n                        ? {\n                            ...previewProps.style,\n                          }\n                        : {}),\n                    }\n                  : {}),\n              }}\n              type=\"button\"\n            >\n              Exit preview mode\n            </button>\n          )}\n        </div>\n        <a\n          className={classNames?.logout}\n          href={`${cmsURL}${adminPath}/logout`}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n          {...logoutProps}\n          style={{\n            ...(unstyled !== true\n              ? {\n                  color: 'inherit',\n                  display: 'block',\n                  flexShrink: 1,\n                  overflow: 'hidden',\n                  textDecoration: 'none',\n                  textOverflow: 'ellipsis',\n                  whiteSpace: 'nowrap',\n                  ...(logoutProps?.style\n                    ? {\n                        ...logoutProps.style,\n                      }\n                    : {}),\n                }\n              : {}),\n          }}\n        >\n          <span\n            style={{\n              ...(unstyled !== true\n                ? {\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    whiteSpace: 'nowrap',\n                  }\n                : {}),\n            }}\n          >\n            Logout\n          </span>\n        </a>\n      </div>\n    )\n  }\n\n  return null\n}\n"],"names":["React","useEffect","useState","dummyUser","id","email","PayloadAdminBar","props","docID","adminPath","apiPath","authCollectionSlug","className","classNames","cmsURL","collectionLabels","collectionSlug","createProps","devMode","divProps","editProps","logo","logoProps","logoutProps","onAuthChange","onPreviewExit","preview","previewProps","style","unstyled","userProps","user","setUser","fetchMe","meRequest","fetch","credentials","method","meResponse","json","err","console","warn","userID","div","alignItems","backgroundColor","boxSizing","color","display","fontFamily","fontSize","left","minWidth","padding","position","top","width","zIndex","a","href","flexShrink","height","marginRight","textDecoration","rel","target","overflow","textOverflow","whiteSpace","span","controls","flexGrow","justifyContent","edit","singular","create","button","onClick","background","border","cursor","marginLeft","type","logout"],"mappings":"AAAA;;AACA,OAAOA,SAASC,SAAS,EAAEC,QAAQ,QAAQ,QAAO;AAElD,MAAMC,YAAY;IAChBC,IAAI;IACJC,OAAO;AACT;AAIA,OAAO,MAAMC,kBAAkD,CAACC;IAC9D,MAAM,EACJH,IAAII,KAAK,EACTC,YAAY,QAAQ,EACpBC,UAAU,MAAM,EAChBC,qBAAqB,OAAO,EAC5BC,SAAS,EACTC,UAAU,EACVC,SAAS,uBAAuB,EAChCC,gBAAgB,EAChBC,cAAc,EACdC,WAAW,EACXC,OAAO,EACPC,QAAQ,EACRC,SAAS,EACTC,IAAI,EACJC,SAAS,EACTC,WAAW,EACXC,YAAY,EACZC,aAAa,EACbC,OAAO,EACPC,YAAY,EACZC,KAAK,EACLC,QAAQ,EACRC,SAAS,EACV,GAAGvB;IAEJ,MAAM,CAACwB,MAAMC,QAAQ,GAAG9B;IAExBD,UAAU;QACR,MAAMgC,UAAU;YACd,IAAI;gBACF,MAAMC,YAAY,MAAMC,MAAM,GAAGrB,SAASJ,QAAQ,CAAC,EAAEC,mBAAmB,GAAG,CAAC,EAAE;oBAC5EyB,aAAa;oBACbC,QAAQ;gBACV;gBACA,MAAMC,aAAa,MAAMJ,UAAUK,IAAI;gBACvC,MAAM,EAAER,IAAI,EAAE,GAAGO;gBAEjB,IAAIP,MAAM;oBACRC,QAAQD;gBACV,OAAO;oBACL,IAAIb,YAAY,MAAM;wBACpBc,QAAQ;oBACV,OAAO;wBACLA,QAAQ7B;oBACV;gBACF;YACF,EAAE,OAAOqC,KAAK;gBACZC,QAAQC,IAAI,CAACF;gBACb,IAAItB,YAAY,MAAM;oBACpBc,QAAQ7B;gBACV;YACF;QACF;QAEA,KAAK8B;IACP,GAAG;QAACnB;QAAQL;QAAWC;QAASQ;KAAQ;IAExCjB,UAAU;QACR,IAAI,OAAOuB,iBAAiB,YAAY;YACtCA,aAAaO;QACf;IACF,GAAG;QAACA;QAAMP;KAAa;IAEvB,IAAIO,MAAM;QACR,MAAM,EAAE3B,IAAIuC,MAAM,EAAEtC,KAAK,EAAE,GAAG0B;QAE9B,qBACE,MAACa;YACChC,WAAWA;YACXR,IAAG;YACHwB,OAAO;gBACL,GAAIC,aAAa,OACb;oBACEgB,YAAY;oBACZC,iBAAiB;oBACjBC,WAAW;oBACXC,OAAO;oBACPC,SAAS;oBACTC,YACE;oBACFC,UAAU;oBACVC,MAAM;oBACNC,UAAU;oBACVC,SAAS;oBACTC,UAAU;oBACVC,KAAK;oBACLC,OAAO;oBACPC,QAAQ;gBACV,IACA,CAAC,CAAC;gBACN,GAAG9B,KAAK;YACV;;8BAEA,KAAC+B;oBACC/C,WAAWC,YAAYQ;oBACvBuC,MAAM,GAAG9C,SAASL,WAAW;oBAC5B,GAAGa,SAAS;oBACbM,OAAO;wBACL,GAAIC,aAAa,OACb;4BACEgB,YAAY;4BACZG,OAAO;4BACPC,SAAS;4BACTY,YAAY;4BACZC,QAAQ;4BACRC,aAAa;4BACbC,gBAAgB;4BAChB,GAAI1C,WAAWM,QACX;gCACE,GAAGN,UAAUM,KAAK;4BACpB,IACA,CAAC,CAAC;wBACR,IACA,CAAC,CAAC;oBACR;8BAECP,QAAQ;;8BAEX,KAACsC;oBACC/C,WAAWC,YAAYkB;oBACvB6B,MAAM,GAAG9C,SAASL,UAAU,aAAa,EAAEE,mBAAmB,CAAC,EAAEgC,QAAQ;oBACzEsB,KAAI;oBACJC,QAAO;oBACN,GAAGpC,SAAS;oBACbF,OAAO;wBACL,GAAIC,aAAa,OACb;4BACEmB,OAAO;4BACPC,SAAS;4BACTc,aAAa;4BACbV,UAAU;4BACVc,UAAU;4BACVH,gBAAgB;4BAChBI,cAAc;4BACdC,YAAY;4BACZ,GAAIvC,WAAWF,QACX;gCACE,GAAGE,UAAUF,KAAK;4BACpB,IACA,CAAC,CAAC;wBACR,IACA,CAAC,CAAC;oBACR;8BAEA,cAAA,KAAC0C;wBACC1C,OAAO;4BACL,GAAIC,aAAa,OACb;gCACEsC,UAAU;gCACVC,cAAc;gCACdC,YAAY;4BACd,IACA,CAAC,CAAC;wBACR;kCAEChE,SAAS;;;8BAGd,MAACuC;oBACChC,WAAWC,YAAY0D;oBACtB,GAAGpD,QAAQ;oBACZS,OAAO;wBACL,GAAIC,aAAa,OACb;4BACEgB,YAAY;4BACZI,SAAS;4BACTuB,UAAU;4BACVX,YAAY;4BACZY,gBAAgB;4BAChBV,aAAa;4BACb,GAAI5C,UAAUS,QACV;gCACE,GAAGT,SAASS,KAAK;4BACnB,IACA,CAAC,CAAC;wBACR,IACA,CAAC,CAAC;oBACR;;wBAECZ,kBAAkBR,uBACjB,KAACmD;4BACC/C,WAAWC,YAAY6D;4BACvBd,MAAM,GAAG9C,SAASL,UAAU,aAAa,EAAEO,eAAe,CAAC,EAAER,OAAO;4BACpEyD,KAAI;4BACJC,QAAO;4BACN,GAAG9C,SAAS;4BACbQ,OAAO;gCACLqB,SAAS;gCACT,GAAIpB,aAAa,OACb;oCACEmB,OAAO;oCACPa,YAAY;oCACZE,aAAa;oCACbI,UAAU;oCACVH,gBAAgB;oCAChBI,cAAc;oCACdC,YAAY;oCACZ,GAAIjD,WAAWQ,QACX;wCACE,GAAGR,UAAUQ,KAAK;oCACpB,IACA,CAAC,CAAC;gCACR,IACA,CAAC,CAAC;4BACR;sCAEA,cAAA,KAAC0C;gCACC1C,OAAO;oCACL,GAAIC,aAAa,OACb;wCACEsC,UAAU;wCACVC,cAAc;wCACdC,YAAY;oCACd,IACA,CAAC,CAAC;gCACR;0CAEC,CAAC,KAAK,EAAEtD,kBAAkB4D,YAAY,QAAQ;;;wBAIpD3D,gCACC,KAAC2C;4BACC/C,WAAWC,YAAY+D;4BACvBhB,MAAM,GAAG9C,SAASL,UAAU,aAAa,EAAEO,eAAe,OAAO,CAAC;4BAClEiD,KAAI;4BACJC,QAAO;4BACN,GAAGjD,WAAW;4BACfW,OAAO;gCACL,GAAIC,aAAa,OACb;oCACEmB,OAAO;oCACPC,SAAS;oCACTY,YAAY;oCACZM,UAAU;oCACVH,gBAAgB;oCAChBI,cAAc;oCACdC,YAAY;oCACZ,GAAIpD,aAAaW,QACb;wCACE,GAAGX,YAAYW,KAAK;oCACtB,IACA,CAAC,CAAC;gCACR,IACA,CAAC,CAAC;4BACR;sCAEA,cAAA,KAAC0C;gCACC1C,OAAO;oCACL,GAAIC,aAAa,OACb;wCACEsC,UAAU;wCACVC,cAAc;wCACdC,YAAY;oCACd,IACA,CAAC,CAAC;gCACR;0CAEC,CAAC,IAAI,EAAEtD,kBAAkB4D,YAAY,QAAQ;;;wBAInDjD,yBACC,KAACmD;4BACCjE,WAAWC,YAAYa;4BACvBoD,SAASrD;4BACR,GAAGE,YAAY;4BAChBC,OAAO;gCACL,GAAIC,aAAa,OACb;oCACEkD,YAAY;oCACZC,QAAQ;oCACRhC,OAAO;oCACPiC,QAAQ;oCACR/B,YAAY;oCACZC,UAAU;oCACV+B,YAAY;oCACZ5B,SAAS;oCACT,GAAI3B,cAAcC,QACd;wCACE,GAAGD,aAAaC,KAAK;oCACvB,IACA,CAAC,CAAC;gCACR,IACA,CAAC,CAAC;4BACR;4BACAuD,MAAK;sCACN;;;;8BAKL,KAACxB;oBACC/C,WAAWC,YAAYuE;oBACvBxB,MAAM,GAAG9C,SAASL,UAAU,OAAO,CAAC;oBACpCwD,KAAI;oBACJC,QAAO;oBACN,GAAG3C,WAAW;oBACfK,OAAO;wBACL,GAAIC,aAAa,OACb;4BACEmB,OAAO;4BACPC,SAAS;4BACTY,YAAY;4BACZM,UAAU;4BACVH,gBAAgB;4BAChBI,cAAc;4BACdC,YAAY;4BACZ,GAAI9C,aAAaK,QACb;gCACE,GAAGL,YAAYK,KAAK;4BACtB,IACA,CAAC,CAAC;wBACR,IACA,CAAC,CAAC;oBACR;8BAEA,cAAA,KAAC0C;wBACC1C,OAAO;4BACL,GAAIC,aAAa,OACb;gCACEsC,UAAU;gCACVC,cAAc;gCACdC,YAAY;4BACd,IACA,CAAC,CAAC;wBACR;kCACD;;;;;IAMT;IAEA,OAAO;AACT,EAAC"}