{"version":3,"file":"metadata.js","names":["getNextRequestI18n","generateAccountViewMetadata","generateCreateFirstUserViewMetadata","generateDashboardViewMetadata","generateDocumentViewMetadata","generateForgotPasswordViewMetadata","generateListViewMetadata","generateLoginViewMetadata","generateNotFoundViewMetadata","generateResetPasswordViewMetadata","generateUnauthorizedViewMetadata","generateVerifyViewMetadata","generateCustomViewMetadata","getCustomViewByRoute","oneSegmentMeta","forgot","login","logout","unauthorized","generatePageMetadata","config","configPromise","params","paramsPromise","segments","Array","isArray","currentRoute","join","segmentOne","segmentTwo","isGlobal","isCollection","i18n","meta","collectionConfig","length","collections","find","collection","slug","globalConfig","globals","global","admin","routes","reset","viewConfig","viewKey"],"sources":["../../../src/views/Root/metadata.ts"],"sourcesContent":["import type { Metadata } from 'next'\nimport type { SanitizedConfig } from 'payload'\n\nimport { getNextRequestI18n } from '../../utilities/getNextRequestI18n.js'\nimport { generateAccountViewMetadata } from '../Account/metadata.js'\nimport { generateCreateFirstUserViewMetadata } from '../CreateFirstUser/metadata.js'\nimport { generateDashboardViewMetadata } from '../Dashboard/metadata.js'\nimport { generateDocumentViewMetadata } from '../Document/metadata.js'\nimport { generateForgotPasswordViewMetadata } from '../ForgotPassword/metadata.js'\nimport { generateListViewMetadata } from '../List/metadata.js'\nimport { generateLoginViewMetadata } from '../Login/metadata.js'\nimport { generateNotFoundViewMetadata } from '../NotFound/metadata.js'\nimport { generateResetPasswordViewMetadata } from '../ResetPassword/metadata.js'\nimport { generateUnauthorizedViewMetadata } from '../Unauthorized/metadata.js'\nimport { generateVerifyViewMetadata } from '../Verify/metadata.js'\nimport { generateCustomViewMetadata } from './generateCustomViewMetadata.js'\nimport { getCustomViewByRoute } from './getCustomViewByRoute.js'\n\nconst oneSegmentMeta = {\n  'create-first-user': generateCreateFirstUserViewMetadata,\n  forgot: generateForgotPasswordViewMetadata,\n  login: generateLoginViewMetadata,\n  logout: generateUnauthorizedViewMetadata,\n  'logout-inactivity': generateUnauthorizedViewMetadata,\n  unauthorized: generateUnauthorizedViewMetadata,\n}\n\ntype Args = {\n  config: Promise<SanitizedConfig>\n  params: Promise<{\n    [key: string]: string | string[]\n  }>\n  searchParams: Promise<{\n    [key: string]: string | string[]\n  }>\n}\n\nexport const generatePageMetadata = async ({\n  config: configPromise,\n  params: paramsPromise,\n}: Args) => {\n  const config = await configPromise\n\n  const params = await paramsPromise\n  const segments = Array.isArray(params.segments) ? params.segments : []\n\n  const currentRoute = `/${segments.join('/')}`\n  const [segmentOne, segmentTwo] = segments\n\n  const isGlobal = segmentOne === 'globals'\n  const isCollection = segmentOne === 'collections'\n\n  const i18n = await getNextRequestI18n({\n    config,\n  })\n\n  let meta: Metadata\n\n  // TODO: handle custom routes\n\n  const collectionConfig =\n    isCollection &&\n    segments.length > 1 &&\n    config?.collections?.find((collection) => collection.slug === segmentTwo)\n\n  const globalConfig =\n    isGlobal && segments.length > 1 && config?.globals?.find((global) => global.slug === segmentTwo)\n\n  switch (segments.length) {\n    case 0: {\n      meta = await generateDashboardViewMetadata({ config, i18n })\n      break\n    }\n    case 1: {\n      if (oneSegmentMeta[segmentOne] && segmentOne !== 'account') {\n        // --> /create-first-user\n        // --> /forgot\n        // --> /login\n        // --> /logout\n        // --> /logout-inactivity\n        // --> /unauthorized\n        meta = await oneSegmentMeta[segmentOne]({ config, i18n })\n        break\n      } else if (segmentOne === 'account') {\n        // --> /account\n        meta = await generateAccountViewMetadata({ config, i18n })\n        break\n      }\n      break\n    }\n    case 2: {\n      if (`/${segmentOne}` === config.admin.routes.reset) {\n        // --> /reset/:token\n        meta = await generateResetPasswordViewMetadata({ config, i18n })\n      }\n      if (isCollection) {\n        // --> /collections/:collectionSlug\n        meta = await generateListViewMetadata({ collectionConfig, config, i18n })\n      } else if (isGlobal) {\n        // --> /globals/:globalSlug\n        meta = await generateDocumentViewMetadata({\n          config,\n          globalConfig,\n          i18n,\n          params,\n        })\n      }\n      break\n    }\n    default: {\n      if (segmentTwo === 'verify') {\n        // --> /:collectionSlug/verify/:token\n        meta = await generateVerifyViewMetadata({ config, i18n })\n      } else if (isCollection) {\n        // Custom Views\n        // --> /collections/:collectionSlug/:id\n        // --> /collections/:collectionSlug/:id/preview\n        // --> /collections/:collectionSlug/:id/versions\n        // --> /collections/:collectionSlug/:id/versions/:version\n        // --> /collections/:collectionSlug/:id/api\n        meta = await generateDocumentViewMetadata({ collectionConfig, config, i18n, params })\n      } else if (isGlobal) {\n        // Custom Views\n        // --> /globals/:globalSlug/versions\n        // --> /globals/:globalSlug/versions/:version\n        // --> /globals/:globalSlug/preview\n        // --> /globals/:globalSlug/api\n        meta = await generateDocumentViewMetadata({\n          config,\n          globalConfig,\n          i18n,\n          params,\n        })\n      }\n      break\n    }\n  }\n\n  if (!meta) {\n    const { viewConfig, viewKey } = getCustomViewByRoute({\n      config,\n      currentRoute,\n    })\n\n    if (viewKey) {\n      // Custom Views\n      // --> /:path\n      meta = await generateCustomViewMetadata({\n        config,\n        i18n,\n        viewConfig,\n      })\n    } else {\n      meta = await generateNotFoundViewMetadata({ config, i18n })\n    }\n  }\n\n  return meta\n}\n"],"mappings":"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","ignoreList":[]}