{"version":3,"sources":["../../src/field/createFeatureMap.ts"],"sourcesContent":["import type { ClientField } from 'payload'\n\nimport type { EnabledFeatures } from './types.js'\n\nexport const createFeatureMap = (\n  richTextComponentMap: Map<string, ClientField[] | React.ReactNode>,\n): EnabledFeatures => {\n  const features: EnabledFeatures = {\n    elements: {},\n    leaves: {},\n    plugins: [],\n  }\n\n  for (const [key, value] of richTextComponentMap) {\n    if (Array.isArray(value)) {\n      continue // We only wanna process react nodes here\n    }\n    if (key.startsWith('leaf.button') || key.startsWith('leaf.component.')) {\n      const leafName = key.replace('leaf.button.', '').replace('leaf.component.', '')\n\n      if (!features.leaves[leafName]) {\n        features.leaves[leafName] = {\n          name: leafName,\n          Button: null,\n          Leaf: null,\n        }\n      }\n\n      if (key.startsWith('leaf.button.')) {\n        features.leaves[leafName].Button = value\n      }\n      if (key.startsWith('leaf.component.')) {\n        features.leaves[leafName].Leaf = value\n      }\n    }\n\n    if (key.startsWith('element.button.') || key.startsWith('element.component.')) {\n      const elementName = key.replace('element.button.', '').replace('element.component.', '')\n\n      if (!features.elements[elementName]) {\n        features.elements[elementName] = {\n          name: elementName,\n          Button: null,\n          Element: null,\n        }\n      }\n\n      if (key.startsWith('element.button.')) {\n        features.elements[elementName].Button = value\n      }\n      if (key.startsWith('element.component.')) {\n        features.elements[elementName].Element = value\n      }\n    }\n\n    if (key.startsWith('leaf.plugin.') || key.startsWith('element.plugin.')) {\n      features.plugins.push(value)\n    }\n  }\n\n  return features\n}\n"],"names":["createFeatureMap","richTextComponentMap","features","elements","leaves","plugins","key","value","Array","isArray","startsWith","leafName","replace","name","Button","Leaf","elementName","Element","push"],"mappings":"AAIA,OAAO,MAAMA,mBAAmB,CAC9BC;IAEA,MAAMC,WAA4B;QAChCC,UAAU,CAAC;QACXC,QAAQ,CAAC;QACTC,SAAS,EAAE;IACb;IAEA,KAAK,MAAM,CAACC,KAAKC,MAAM,IAAIN,qBAAsB;QAC/C,IAAIO,MAAMC,OAAO,CAACF,QAAQ;YACxB,UAAS,yCAAyC;QACpD;QACA,IAAID,IAAII,UAAU,CAAC,kBAAkBJ,IAAII,UAAU,CAAC,oBAAoB;YACtE,MAAMC,WAAWL,IAAIM,OAAO,CAAC,gBAAgB,IAAIA,OAAO,CAAC,mBAAmB;YAE5E,IAAI,CAACV,SAASE,MAAM,CAACO,SAAS,EAAE;gBAC9BT,SAASE,MAAM,CAACO,SAAS,GAAG;oBAC1BE,MAAMF;oBACNG,QAAQ;oBACRC,MAAM;gBACR;YACF;YAEA,IAAIT,IAAII,UAAU,CAAC,iBAAiB;gBAClCR,SAASE,MAAM,CAACO,SAAS,CAACG,MAAM,GAAGP;YACrC;YACA,IAAID,IAAII,UAAU,CAAC,oBAAoB;gBACrCR,SAASE,MAAM,CAACO,SAAS,CAACI,IAAI,GAAGR;YACnC;QACF;QAEA,IAAID,IAAII,UAAU,CAAC,sBAAsBJ,IAAII,UAAU,CAAC,uBAAuB;YAC7E,MAAMM,cAAcV,IAAIM,OAAO,CAAC,mBAAmB,IAAIA,OAAO,CAAC,sBAAsB;YAErF,IAAI,CAACV,SAASC,QAAQ,CAACa,YAAY,EAAE;gBACnCd,SAASC,QAAQ,CAACa,YAAY,GAAG;oBAC/BH,MAAMG;oBACNF,QAAQ;oBACRG,SAAS;gBACX;YACF;YAEA,IAAIX,IAAII,UAAU,CAAC,oBAAoB;gBACrCR,SAASC,QAAQ,CAACa,YAAY,CAACF,MAAM,GAAGP;YAC1C;YACA,IAAID,IAAII,UAAU,CAAC,uBAAuB;gBACxCR,SAASC,QAAQ,CAACa,YAAY,CAACC,OAAO,GAAGV;YAC3C;QACF;QAEA,IAAID,IAAII,UAAU,CAAC,mBAAmBJ,IAAII,UAAU,CAAC,oBAAoB;YACvER,SAASG,OAAO,CAACa,IAAI,CAACX;QACxB;IACF;IAEA,OAAOL;AACT,EAAC"}