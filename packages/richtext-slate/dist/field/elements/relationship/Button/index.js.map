{"version":3,"sources":["../../../../../src/field/elements/relationship/Button/index.tsx"],"sourcesContent":["'use client'\nimport type { ListDrawerProps } from '@payloadcms/ui'\n\nimport { useListDrawer, useTranslation } from '@payloadcms/ui'\nimport React, { Fragment, useCallback, useState } from 'react'\nimport { ReactEditor, useSlate } from 'slate-react'\n\nimport { RelationshipIcon } from '../../../icons/Relationship/index.js'\nimport { ElementButton } from '../../Button.js'\nimport { EnabledRelationshipsCondition } from '../../EnabledRelationshipsCondition.js'\nimport { injectVoidElement } from '../../injectVoid.js'\nimport './index.scss'\n\nconst baseClass = 'relationship-rich-text-button'\n\nconst insertRelationship = (editor, { relationTo, value }) => {\n  const text = { text: ' ' }\n\n  const relationship = {\n    type: 'relationship',\n    children: [text],\n    relationTo,\n    value,\n  }\n\n  injectVoidElement(editor, relationship)\n\n  ReactEditor.focus(editor)\n}\n\ntype Props = {\n  enabledCollectionSlugs: string[]\n  path: string\n}\nconst RelationshipButtonComponent: React.FC<Props> = ({ enabledCollectionSlugs }) => {\n  const { t } = useTranslation()\n  const editor = useSlate()\n  const [selectedCollectionSlug] = useState(() => enabledCollectionSlugs[0])\n  const [ListDrawer, ListDrawerToggler, { closeDrawer }] = useListDrawer({\n    collectionSlugs: enabledCollectionSlugs,\n    selectedCollection: selectedCollectionSlug,\n  })\n\n  const onSelect = useCallback<NonNullable<ListDrawerProps['onSelect']>>(\n    ({ collectionSlug, docID }) => {\n      insertRelationship(editor, {\n        relationTo: collectionSlug,\n        value: {\n          id: docID,\n        },\n      })\n      closeDrawer()\n    },\n    [editor, closeDrawer],\n  )\n\n  return (\n    <Fragment>\n      <ListDrawerToggler>\n        <ElementButton\n          className={baseClass}\n          el=\"div\"\n          format=\"relationship\"\n          onClick={() => {\n            // do nothing\n          }}\n          tooltip={t('fields:addRelationship')}\n        >\n          <RelationshipIcon />\n        </ElementButton>\n      </ListDrawerToggler>\n      <ListDrawer onSelect={onSelect} />\n    </Fragment>\n  )\n}\n\nexport const RelationshipButton = (props: Props): React.ReactNode => {\n  return (\n    <EnabledRelationshipsCondition {...props}>\n      <RelationshipButtonComponent {...props} />\n    </EnabledRelationshipsCondition>\n  )\n}\n"],"names":["useListDrawer","useTranslation","React","Fragment","useCallback","useState","ReactEditor","useSlate","RelationshipIcon","ElementButton","EnabledRelationshipsCondition","injectVoidElement","baseClass","insertRelationship","editor","relationTo","value","text","relationship","type","children","focus","RelationshipButtonComponent","enabledCollectionSlugs","t","selectedCollectionSlug","ListDrawer","ListDrawerToggler","closeDrawer","collectionSlugs","selectedCollection","onSelect","collectionSlug","docID","id","className","el","format","onClick","tooltip","RelationshipButton","props"],"mappings":"AAAA;;AAGA,SAASA,aAAa,EAAEC,cAAc,QAAQ,iBAAgB;AAC9D,OAAOC,SAASC,QAAQ,EAAEC,WAAW,EAAEC,QAAQ,QAAQ,QAAO;AAC9D,SAASC,WAAW,EAAEC,QAAQ,QAAQ,cAAa;AAEnD,SAASC,gBAAgB,QAAQ,uCAAsC;AACvE,SAASC,aAAa,QAAQ,kBAAiB;AAC/C,SAASC,6BAA6B,QAAQ,yCAAwC;AACtF,SAASC,iBAAiB,QAAQ,sBAAqB;AACvD,OAAO,eAAc;AAErB,MAAMC,YAAY;AAElB,MAAMC,qBAAqB,CAACC,QAAQ,EAAEC,UAAU,EAAEC,KAAK,EAAE;IACvD,MAAMC,OAAO;QAAEA,MAAM;IAAI;IAEzB,MAAMC,eAAe;QACnBC,MAAM;QACNC,UAAU;YAACH;SAAK;QAChBF;QACAC;IACF;IAEAL,kBAAkBG,QAAQI;IAE1BZ,YAAYe,KAAK,CAACP;AACpB;AAMA,MAAMQ,8BAA+C,CAAC,EAAEC,sBAAsB,EAAE;IAC9E,MAAM,EAAEC,CAAC,EAAE,GAAGvB;IACd,MAAMa,SAASP;IACf,MAAM,CAACkB,uBAAuB,GAAGpB,SAAS,IAAMkB,sBAAsB,CAAC,EAAE;IACzE,MAAM,CAACG,YAAYC,mBAAmB,EAAEC,WAAW,EAAE,CAAC,GAAG5B,cAAc;QACrE6B,iBAAiBN;QACjBO,oBAAoBL;IACtB;IAEA,MAAMM,WAAW3B,YACf,CAAC,EAAE4B,cAAc,EAAEC,KAAK,EAAE;QACxBpB,mBAAmBC,QAAQ;YACzBC,YAAYiB;YACZhB,OAAO;gBACLkB,IAAID;YACN;QACF;QACAL;IACF,GACA;QAACd;QAAQc;KAAY;IAGvB,qBACE,MAACzB;;0BACC,KAACwB;0BACC,cAAA,KAAClB;oBACC0B,WAAWvB;oBACXwB,IAAG;oBACHC,QAAO;oBACPC,SAAS;oBACP,aAAa;oBACf;oBACAC,SAASf,EAAE;8BAEX,cAAA,KAAChB;;;0BAGL,KAACkB;gBAAWK,UAAUA;;;;AAG5B;AAEA,OAAO,MAAMS,qBAAqB,CAACC;IACjC,qBACE,KAAC/B;QAA+B,GAAG+B,KAAK;kBACtC,cAAA,KAACnB;YAA6B,GAAGmB,KAAK;;;AAG5C,EAAC"}