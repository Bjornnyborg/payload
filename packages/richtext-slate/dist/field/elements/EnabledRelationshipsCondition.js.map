{"version":3,"sources":["../../../src/field/elements/EnabledRelationshipsCondition.tsx"],"sourcesContent":["'use client'\n\nimport type { ClientCollectionConfig, ClientUser, VisibleEntities } from 'payload'\n\nimport { useAuth, useConfig, useEntityVisibility } from '@payloadcms/ui'\nimport * as React from 'react'\n\ntype Options = {\n  uploads: boolean\n  user: ClientUser\n  visibleEntities: VisibleEntities\n}\n\ntype FilteredCollectionsT = (\n  collections: ClientCollectionConfig[],\n  options?: Options,\n) => ClientCollectionConfig[]\n\nconst filterRichTextCollections: FilteredCollectionsT = (collections, options) => {\n  return collections.filter(({ slug, admin: { enableRichTextRelationship }, upload }) => {\n    if (!options.visibleEntities.collections.includes(slug)) {\n      return false\n    }\n\n    if (options?.uploads) {\n      return enableRichTextRelationship && Boolean(upload) === true\n    }\n\n    return upload ? false : enableRichTextRelationship\n  })\n}\n\nexport const EnabledRelationshipsCondition: React.FC<any> = (props) => {\n  const { children, uploads = false, ...rest } = props\n  const {\n    config: { collections },\n  } = useConfig()\n  const { user } = useAuth()\n  const { visibleEntities } = useEntityVisibility()\n\n  const [enabledCollectionSlugs] = React.useState(() =>\n    filterRichTextCollections(collections, { uploads, user, visibleEntities }).map(\n      ({ slug }) => slug,\n    ),\n  )\n\n  if (!enabledCollectionSlugs.length) {\n    return null\n  }\n\n  return React.cloneElement(children, { ...rest, enabledCollectionSlugs })\n}\n"],"names":["useAuth","useConfig","useEntityVisibility","React","filterRichTextCollections","collections","options","filter","slug","admin","enableRichTextRelationship","upload","visibleEntities","includes","uploads","Boolean","EnabledRelationshipsCondition","props","children","rest","config","user","enabledCollectionSlugs","useState","map","length","cloneElement"],"mappings":"AAAA;AAIA,SAASA,OAAO,EAAEC,SAAS,EAAEC,mBAAmB,QAAQ,iBAAgB;AACxE,YAAYC,WAAW,QAAO;AAa9B,MAAMC,4BAAkD,CAACC,aAAaC;IACpE,OAAOD,YAAYE,MAAM,CAAC,CAAC,EAAEC,IAAI,EAAEC,OAAO,EAAEC,0BAA0B,EAAE,EAAEC,MAAM,EAAE;QAChF,IAAI,CAACL,QAAQM,eAAe,CAACP,WAAW,CAACQ,QAAQ,CAACL,OAAO;YACvD,OAAO;QACT;QAEA,IAAIF,SAASQ,SAAS;YACpB,OAAOJ,8BAA8BK,QAAQJ,YAAY;QAC3D;QAEA,OAAOA,SAAS,QAAQD;IAC1B;AACF;AAEA,OAAO,MAAMM,gCAA+C,CAACC;IAC3D,MAAM,EAAEC,QAAQ,EAAEJ,UAAU,KAAK,EAAE,GAAGK,MAAM,GAAGF;IAC/C,MAAM,EACJG,QAAQ,EAAEf,WAAW,EAAE,EACxB,GAAGJ;IACJ,MAAM,EAAEoB,IAAI,EAAE,GAAGrB;IACjB,MAAM,EAAEY,eAAe,EAAE,GAAGV;IAE5B,MAAM,CAACoB,uBAAuB,GAAGnB,MAAMoB,QAAQ,CAAC,IAC9CnB,0BAA0BC,aAAa;YAAES;YAASO;YAAMT;QAAgB,GAAGY,GAAG,CAC5E,CAAC,EAAEhB,IAAI,EAAE,GAAKA;IAIlB,IAAI,CAACc,uBAAuBG,MAAM,EAAE;QAClC,OAAO;IACT;IAEA,qBAAOtB,MAAMuB,YAAY,CAACR,UAAU;QAAE,GAAGC,IAAI;QAAEG;IAAuB;AACxE,EAAC"}