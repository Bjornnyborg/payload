{"version":3,"sources":["../src/subscribe.ts"],"sourcesContent":["import { handleMessage } from './handleMessage.js'\n\nexport const subscribe = <T extends Record<string, any>>(args: {\n  apiRoute?: string\n  callback: (data: T) => void\n  depth?: number\n  initialData: T\n  serverURL: string\n}): ((event: MessageEvent) => Promise<void> | void) => {\n  const { apiRoute, callback, depth, initialData, serverURL } = args\n\n  const onMessage = async (event: MessageEvent) => {\n    const mergedData = await handleMessage<T>({\n      apiRoute,\n      depth,\n      event,\n      initialData,\n      serverURL,\n    })\n\n    callback(mergedData)\n  }\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('message', onMessage)\n  }\n\n  return onMessage\n}\n"],"names":["handleMessage","subscribe","args","apiRoute","callback","depth","initialData","serverURL","onMessage","event","mergedData","window","addEventListener"],"mappings":"AAAA,SAASA,aAAa,QAAQ,qBAAoB;AAElD,OAAO,MAAMC,YAAY,CAAgCC;IAOvD,MAAM,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,WAAW,EAAEC,SAAS,EAAE,GAAGL;IAE9D,MAAMM,YAAY,OAAOC;QACvB,MAAMC,aAAa,MAAMV,cAAiB;YACxCG;YACAE;YACAI;YACAH;YACAC;QACF;QAEAH,SAASM;IACX;IAEA,IAAI,OAAOC,WAAW,aAAa;QACjCA,OAAOC,gBAAgB,CAAC,WAAWJ;IACrC;IAEA,OAAOA;AACT,EAAC"}