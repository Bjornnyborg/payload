{"version":3,"file":"index.js","names":["React","useCallback","useMemo","useField","withCondition","mergeFieldStyles","SelectInput","formatOptions","options","map","option","value","label","SelectFieldComponent","props","field","name","admin","className","description","isClearable","isSortable","hasMany","localized","optionsFromProps","required","onChange","onChangeFromProps","path","pathFromProps","readOnly","validate","memoizedValidate","validationOptions","customComponents","AfterInput","BeforeInput","Description","Error","Label","disabled","setValue","showError","potentiallyStalePath","selectedOption","newValue","Array","isArray","styles","_jsx","style","SelectField"],"sources":["../../../src/fields/Select/index.tsx"],"sourcesContent":["'use client'\nimport type {\n  Option,\n  OptionObject,\n  SelectFieldClientComponent,\n  SelectFieldClientProps,\n} from 'payload'\n\nimport React, { useCallback, useMemo } from 'react'\n\nimport type { ReactSelectAdapterProps } from '../../elements/ReactSelect/types.js'\nimport type { SelectInputProps } from './Input.js'\n\nimport { useField } from '../../forms/useField/index.js'\nimport { withCondition } from '../../forms/withCondition/index.js'\nimport { mergeFieldStyles } from '../mergeFieldStyles.js'\nimport { SelectInput } from './Input.js'\n\nconst formatOptions = (options: Option[]): OptionObject[] =>\n  options.map((option) => {\n    if (typeof option === 'object' && (option.value || option.value === '')) {\n      return option\n    }\n\n    return {\n      label: option,\n      value: option,\n    } as OptionObject\n  })\n\nconst SelectFieldComponent: SelectFieldClientComponent = (props) => {\n  const {\n    field,\n    field: {\n      name,\n      admin: {\n        className,\n        description,\n        isClearable = true,\n        isSortable = true,\n      } = {} as SelectFieldClientProps['field']['admin'],\n      hasMany = false,\n      label,\n      localized,\n      options: optionsFromProps = [],\n      required,\n    },\n    onChange: onChangeFromProps,\n    path: pathFromProps,\n    readOnly,\n    validate,\n  } = props\n\n  const options = React.useMemo(() => formatOptions(optionsFromProps), [optionsFromProps])\n\n  const memoizedValidate = useCallback(\n    (value, validationOptions) => {\n      if (typeof validate === 'function') {\n        return validate(value, { ...validationOptions, hasMany, options, required })\n      }\n    },\n    [validate, required, hasMany, options],\n  )\n\n  const {\n    customComponents: { AfterInput, BeforeInput, Description, Error, Label } = {},\n    disabled,\n    path,\n    setValue,\n    showError,\n    value,\n  } = useField({\n    potentiallyStalePath: pathFromProps,\n    validate: memoizedValidate,\n  })\n\n  const onChange: ReactSelectAdapterProps['onChange'] = useCallback(\n    (selectedOption: OptionObject | OptionObject[]) => {\n      if (!readOnly || disabled) {\n        let newValue: string | string[] = null\n        if (selectedOption && hasMany) {\n          if (Array.isArray(selectedOption)) {\n            newValue = selectedOption.map((option) => option.value)\n          } else {\n            newValue = []\n          }\n        } else if (selectedOption && !Array.isArray(selectedOption)) {\n          newValue = selectedOption.value\n        }\n\n        if (typeof onChangeFromProps === 'function') {\n          onChangeFromProps(newValue)\n        }\n\n        setValue(newValue)\n      }\n    },\n    [readOnly, disabled, hasMany, setValue, onChangeFromProps],\n  )\n\n  const styles = useMemo(() => mergeFieldStyles(field), [field])\n\n  return (\n    <SelectInput\n      AfterInput={AfterInput}\n      BeforeInput={BeforeInput}\n      className={className}\n      Description={Description}\n      description={description}\n      Error={Error}\n      hasMany={hasMany}\n      isClearable={isClearable}\n      isSortable={isSortable}\n      Label={Label}\n      label={label}\n      localized={localized}\n      name={name}\n      onChange={onChange}\n      options={options}\n      path={path}\n      readOnly={readOnly || disabled}\n      required={required}\n      showError={showError}\n      style={styles}\n      value={value as string | string[]}\n    />\n  )\n}\n\nexport const SelectField = withCondition(SelectFieldComponent)\n\nexport { SelectInput, type SelectInputProps }\n"],"mappings":"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","ignoreList":[]}