{"version":3,"sources":["../../src/utils/git.ts"],"sourcesContent":["import type { ExecSyncOptions } from 'child_process'\n\nimport { execSync } from 'child_process'\n\nimport { warning } from './log.js'\n\nexport function tryInitRepoAndCommit(args: { cwd: string }): void {\n  const execOpts: ExecSyncOptions = { cwd: args.cwd, stdio: 'ignore' }\n  try {\n    // Check if git is available\n    execSync('git -v', execOpts)\n\n    // Do nothing if already in a git repo\n    if (isGitRepo(execOpts)) {\n      return\n    }\n\n    // Initialize\n    execSync('git init', execOpts)\n    if (!ensureHasDefaultBranch(execOpts)) {\n      execSync('git checkout -b main', execOpts)\n    }\n\n    // Add and commit files\n    execSync('git add -A', execOpts)\n    execSync('git commit -m \"feat: initial commit\"', execOpts)\n  } catch (_) {\n    warning('Failed to initialize git repository.')\n  }\n}\n\nfunction isGitRepo(opts: ExecSyncOptions): boolean {\n  try {\n    execSync('git rev-parse --is-inside-work-tree', opts)\n    return true\n  } catch (_) {\n    // Ignore errors\n  }\n  return false\n}\n\nfunction ensureHasDefaultBranch(opts: ExecSyncOptions): boolean {\n  try {\n    execSync(`git config init.defaultBranch`, opts)\n    return true\n  } catch (_) {\n    // Ignore errros\n  }\n  return false\n}\n"],"names":["execSync","warning","tryInitRepoAndCommit","args","execOpts","cwd","stdio","isGitRepo","ensureHasDefaultBranch","_","opts"],"mappings":"AAEA,SAASA,QAAQ,QAAQ,gBAAe;AAExC,SAASC,OAAO,QAAQ,WAAU;AAElC,OAAO,SAASC,qBAAqBC,IAAqB;IACxD,MAAMC,WAA4B;QAAEC,KAAKF,KAAKE,GAAG;QAAEC,OAAO;IAAS;IACnE,IAAI;QACF,4BAA4B;QAC5BN,SAAS,UAAUI;QAEnB,sCAAsC;QACtC,IAAIG,UAAUH,WAAW;YACvB;QACF;QAEA,aAAa;QACbJ,SAAS,YAAYI;QACrB,IAAI,CAACI,uBAAuBJ,WAAW;YACrCJ,SAAS,wBAAwBI;QACnC;QAEA,uBAAuB;QACvBJ,SAAS,cAAcI;QACvBJ,SAAS,wCAAwCI;IACnD,EAAE,OAAOK,GAAG;QACVR,QAAQ;IACV;AACF;AAEA,SAASM,UAAUG,IAAqB;IACtC,IAAI;QACFV,SAAS,uCAAuCU;QAChD,OAAO;IACT,EAAE,OAAOD,GAAG;IACV,gBAAgB;IAClB;IACA,OAAO;AACT;AAEA,SAASD,uBAAuBE,IAAqB;IACnD,IAAI;QACFV,SAAS,CAAC,6BAA6B,CAAC,EAAEU;QAC1C,OAAO;IACT,EAAE,OAAOD,GAAG;IACV,gBAAgB;IAClB;IACA,OAAO;AACT"}